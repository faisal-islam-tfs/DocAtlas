DocAtlas Feature List
=====================

Input & Extraction
- Supports .pdf, .doc, .docx, .ppt, .pptx, .xlsx
- .doc auto-converted to .docx via LibreOffice (if installed)
- PDF extraction via pdfplumber
- OCR for PDFs: OCRmyPDF (non-forced pass, then forced pass only if needed) -> Tesseract fallback
- OCR of embedded images in .docx and .pptx when OCR is enabled
- Extracts Word tables and Excel sheets
- Extracts PowerPoint slide text

Summarization & Classification (LLM)
- Short summary (1â€“2 sentences)
- Long summary (5â€“7 sentences)
- Category assignment from your list
- Tag generation (deduped + capped)
- Article summaries for PDFs

PDF Article Handling
- Splits PDFs into articles using conservative strong-heading heuristics
- Defaults to one article when structure is weak/ambiguous to avoid over-splitting
- Stores article summaries separately

Duplicate Detection
- Exact duplicates: SHA-256 hash
- Near-duplicates: embeddings + cosine similarity
- Embeddings source: full text (default), summary, or none

Outputs
- *_docatlas_summaries.xlsx
  - Documents (compact per-document review)
  - Duplicates (cluster-focused duplicate review)
  - Articles (human-readable per-article summaries)
- *_docatlas_import.xlsx (standalone import sheet for downstream KB import)
- *_docatlas_full_text.xlsx (disabled by default; opt-in with --include-full-text-output)
- summary_report.txt
- duplicate_groups_overview.xlsx inside each <category>_Duplicate folder
- resume.json (cache)
- last_run_stats.json (baseline for estimates)

Organization
- Moves files into category folders
- Duplicate clusters into <category>_Duplicate/<DuplicateClusterID> (includes canonical + duplicate members)
- Auto-rename if file name conflicts
- Low/no-text files routed to Unreadable

GUI
- Folder pickers
- Application/category dropdown + editor
- OCR settings
- Embeddings source + append/overwrite toggle
- Charter Mode (preview-only; no file moves)
- Progress bar + ETA
- Pre-run runtime estimate popup (minutes/hours/days)

CLI
- Full CLI support for input/output/app/categories
- --workers N for parallel CLI processing (default 1)
- --category-path-map to supply import path mapping JSON
- Automatic pre-run validation ensures applications/categories in applications.json and category_path_map.json stay aligned
- --include-full-text-output to re-enable full-text workbook
- --limit and --no-move for estimation runs
- --charter-mode (preview-only; no file moves)
- --overwrite-excel or append default
- --no-resume, --no-ocrmypdf
- --test-chat, --test-embeddings

Reporting & Cost
- Token estimates (chat + embeddings)
- No-text file list
- Extraction status counts
- File type breakdown and category percentages
- OCR usage count and duplicate group stats
- Document length stats (avg/longest/shortest)
- Errors captured per file and reported without stopping the run
- Optional API call delay (DOCATLAS_API_DELAY) to reduce transient socket errors
- Retries for transient API/DNS/network failures with exponential backoff + jitter
  (DOCATLAS_API_MAX_RETRIES, DOCATLAS_API_RETRY_BASE, DOCATLAS_API_RETRY_MAX, DOCATLAS_API_TIMEOUT)

Hidden/Internal Features
- Auto-updated runtime baseline saved after every run
- Quick estimate uses file count + size + baseline
- Resume cache avoids reprocessing unchanged files
- Short-text guard skips embeddings for tiny inputs
- OCR logs note when OCR is triggered
- File key based on path + mtime + size to detect changes

